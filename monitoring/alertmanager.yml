global:
  resolve_timeout: 30s

route:
  group_wait: 10s
  group_interval: 30s
  repeat_interval: 30s
  receiver: 'telegram-notifications'
  # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
  routes:
    - match:
        severity: critical
      receiver: 'telegram-notifications'
      repeat_interval: 30s  # –ß–∞—â–µ –ø–æ–≤—Ç–æ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã
    - match:
        severity: warning
      receiver: 'telegram-notifications'
      repeat_interval: 30s

receivers:
  - name: 'telegram-notifications'
    telegram_configs:
      - bot_token: ''
        chat_id: 
        parse_mode: 'HTML'
        message: |
          {{- range .Alerts }}
          üö® <b>{{ .Status | toUpper }}</b>

          <b>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–µ–≤–æ–≥–µ:</b>
          üì¢ –¢–∏–ø: {{ .Labels.alertname }}
          ‚ö†Ô∏è –í–∞–∂–Ω–æ—Å—Ç—å: {{ .Labels.severity }}
          –•–æ—Å—Ç: {{ .Labels.instance }}

          <b>–î–µ—Ç–∞–ª–∏:</b>
          {{ if .Annotations.value -}}
          {{ if eq .Labels.alertname "HighCPUUsage" }}üíª CPU –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: <b>{{ .Annotations.value }}</b>{{ end -}}
          {{ if eq .Labels.alertname "HighMemoryUsage" }}üíæ –ü–∞–º—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: <b>{{ .Annotations.value }}</b>{{ end -}}
          {{ if eq .Labels.alertname "HighDiskUsage" }}üíΩ –î–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: <b>{{ .Annotations.value }}</b>{{ end -}}
          {{- else }}
          (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)
          {{- end }}

          <b>–û–ø–∏—Å–∞–Ω–∏–µ:</b>
          üìù {{ .Annotations.description }}

          <b>–í—Ä–µ–º—è:</b>
          üïê –ù–∞—á–∞–ª–æ: {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
          {{ if eq .Status "resolved" }}
          ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ: {{ .EndsAt.Format "2006-01-02 15:04:05 MST" }}
          {{ end }}
          ---
          {{ end }}

# –ü—Ä–∞–≤–∏–ª–∞ –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
inhibit_rules:
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'instance'] 
